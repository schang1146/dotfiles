#!/usr/bin/env bash

DOTFILES_ROOT=$(pwd -P)

source "$DOTFILES_ROOT"/scripts/logger

install() {
    if ! which "$1";
    then
        info "Installing: ${1}..."
        sudo sh -c "$2"
    else
        info "Already installed: ${1}"
    fi
}

info "Attempting to update and upgrade packages..."
sudo apt update
sudo apt -y upgrade

for script_loc in $(find "$DOTFILES_ROOT" -name "install.sh")
do
    read -r -p "Run ${script_loc}? (Y/n): " resp
    if [ -z "$resp" ] || [ "$resp" = "y" ];
    then
        info "Running ${script_loc}..."
        install "$(basename $(dirname $script_loc))" "$script_loc"
    fi
done
